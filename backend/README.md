# Backend ‚Äî FastAPI üöÄ

REST API —Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend/
‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ pyproject.toml          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ alembic.ini             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îú‚îÄ‚îÄ alembic/                # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ env.py              # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Alembic –¥–ª—è async
‚îÇ   ‚îú‚îÄ‚îÄ script.py.mako      # –®–∞–±–ª–æ–Ω –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ versions/           # –§–∞–π–ª—ã –º–∏–≥—Ä–∞—Ü–∏–π
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (pydantic-settings)
‚îÇ   ‚îú‚îÄ‚îÄ database.py         # SQLAlchemy engine, session
‚îÇ   ‚îú‚îÄ‚îÄ logger.py           # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ loguru
‚îÇ   ‚îú‚îÄ‚îÄ users/              # –ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py       # SQLAlchemy –º–æ–¥–µ–ª—å User
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ schemas.py      # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crud.py         # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ router.py       # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ events/             # –ú–æ–¥—É–ª—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ models.py       # Event + EventParticipant
‚îÇ       ‚îú‚îÄ‚îÄ schemas.py      # Pydantic —Å—Ö–µ–º—ã
‚îÇ       ‚îú‚îÄ‚îÄ crud.py         # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ       ‚îî‚îÄ‚îÄ router.py       # API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îî‚îÄ‚îÄ Dockerfile              # Docker –æ–±—Ä–∞–∑
```

## üóÉ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | int | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `telegram_id` | bigint | ID –≤ Telegram (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π, –∏–Ω–¥–µ–∫—Å) |
| `username` | str | Username –≤ Telegram |
| `first_name` | str | –ò–º—è |
| `created_at` | datetime | –î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ |

### Event (–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ)
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | int | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `title` | str | –ù–∞–∑–≤–∞–Ω–∏–µ |
| `description` | text | –û–ø–∏—Å–∞–Ω–∏–µ |
| `date` | datetime | –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è |
| `location` | str | –ú–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è |
| `creator_id` | int | FK –Ω–∞ User (–∏–Ω–¥–µ–∫—Å) |
| `created_at` | datetime | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

### EventParticipant (–£—á–∞—Å—Ç–Ω–∏–∫–∏)
| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `id` | int | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á |
| `user_id` | int | FK –Ω–∞ User (–∏–Ω–¥–µ–∫—Å) |
| `event_id` | int | FK –Ω–∞ Event (–∏–Ω–¥–µ–∫—Å) |
| `joined_at` | datetime | –î–∞—Ç–∞ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
uv sync

# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
uv run uvicorn main:app --reload

# –ó–∞–ø—É—Å–∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω
uv run uvicorn main:app --host 0.0.0.0 --port 8000
```

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env`:

**–î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (SQLite):**
```env
DATABASE_URL=sqlite+aiosqlite:///./app.db
DEBUG=true
API_HOST=0.0.0.0
API_PORT=8000
```

**–î–ª—è Docker (PostgreSQL):**
```env
DATABASE_URL=postgresql+asyncpg://postgres:postgres@postgres:5432/vmeste_db
DEBUG=false
API_HOST=0.0.0.0
API_PORT=8000
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –í Docker Compose `DATABASE_URL` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö PostgreSQL.

## üìù –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
uv run alembic revision --autogenerate -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏
uv run alembic upgrade head

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
uv run alembic downgrade -1

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é
uv run alembic current
```

## üìö API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å–∞–º:
- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc
- **OpenAPI JSON**: http://localhost:8000/openapi.json
